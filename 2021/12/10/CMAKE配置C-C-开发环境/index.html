<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>VS code + clangd + Clang + CMAKE配置C/C++开发环境 | 辛巳流火的Blog</title><meta name="keywords" content="C,vscode"><meta name="author" content="辛巳流火"><meta name="copyright" content="辛巳流火"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="结合B站大佬的方法，不用WSL在vscode中配置C&#x2F;C++开发环境">
<meta property="og:type" content="article">
<meta property="og:title" content="VS code + clangd + Clang + CMAKE配置C&#x2F;C++开发环境">
<meta property="og:url" content="https://huguoyang.cn/2021/12/10/CMAKE%E9%85%8D%E7%BD%AEC-C-%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83/index.html">
<meta property="og:site_name" content="辛巳流火的Blog">
<meta property="og:description" content="结合B站大佬的方法，不用WSL在vscode中配置C&#x2F;C++开发环境">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ambition-echo/img_bed/img/1639111789400%E7%94%BB%E6%9D%BF%201.png">
<meta property="article:published_time" content="2021-12-10T12:34:52.000Z">
<meta property="article:modified_time" content="2022-06-02T03:23:14.389Z">
<meta property="article:author" content="辛巳流火">
<meta property="article:tag" content="C">
<meta property="article:tag" content="vscode">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://cdn.jsdelivr.net/gh/ambition-echo/img_bed/img/1639111789400%E7%94%BB%E6%9D%BF%201.png"><link rel="shortcut icon" href="https://cdn.jsdelivr.net/gh/ambition-echo/img_bed/img/20211215232452.png"><link rel="canonical" href="https://huguoyang.cn/2021/12/10/CMAKE%E9%85%8D%E7%BD%AEC-C-%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//www.google-analytics.com" crossorigin=""/><link rel="preconnect" href="//hm.baidu.com"/><link rel="preconnect" href="//www.clarity.ms"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?0a7c721cb2bf64c6070b66fa40348d5c";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script><script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-KTGKK5J3D3"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-KTGKK5J3D3');
</script><script>(function(c,l,a,r,i,t,y){
    c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};
    t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;
    y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);
})(window, document, "clarity", "script", "9qnx908thz");</script><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    jQuery: 'https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js',
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
    },
    fancybox: {
      js: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js',
      css: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isanchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'VS code + clangd + Clang + CMAKE配置C/C++开发环境',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2022-06-02 03:23:14'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if (GLOBAL_CONFIG_SITE.isHome && /iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 5.4.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://cdn.jsdelivr.net/gh/ambition-echo/img_bed/img/20211215232452.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/archives/"><div class="headline">文章</div><div class="length-num">21</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/tags/"><div class="headline">标签</div><div class="length-num">19</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/categories/"><div class="headline">分类</div><div class="length-num">3</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 目录</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 娱乐</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 电影</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://cdn.jsdelivr.net/gh/ambition-echo/img_bed/img/1639111789400%E7%94%BB%E6%9D%BF%201.png')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">辛巳流火的Blog</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 目录</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 娱乐</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 电影</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">VS code + clangd + Clang + CMAKE配置C/C++开发环境</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2021-12-10T12:34:52.000Z" title="发表于 2021-12-10 12:34:52">2021-12-10</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2022-06-02T03:23:14.389Z" title="更新于 2022-06-02 03:23:14">2022-06-02</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Tips/">Tips</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">1.5k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>5分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="VS code + clangd + Clang + CMAKE配置C/C++开发环境"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span><span class="post-meta-separator">|</span><span class="post-meta-commentcount"><i class="far fa-comments fa-fw post-meta-icon"></i><span class="post-meta-label">评论数:</span><a href="/2021/12/10/CMAKE%E9%85%8D%E7%BD%AEC-C-%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83/#post-comment"><span class="gitalk-comment-count"></span></a></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><p>结合B站大佬的方法，不用WSL在vscode中配置C/C++开发环境</p>
<span id="more"></span>

<p>参考B站up主的视频<a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1sW411v7VZ">使用 VS Code + Clangd + CMake 搭建 C/C++开发环境</a>来进行配置。</p>
<p>B站大佬的配置方法很好，但是在Windows下用WSL来进行开发终究还是有点麻烦，而且wsl运行的内存占用，快赶上一些大型IDE了，这样的话配置vscode不就没有必要了吗，为什么不直接使用Clion或者VS呢。</p>
<p>所以找到这些软件尝试不用WSL在windows下配置C/C++开发环境，但最后发现虽然LLVM有windows版本，但是要用到Visual Studio，<del>于是放弃clang，直接用MinGW来配置。</del></p>
<p>今天偶尔发现一个网站<a target="_blank" rel="noopener" href="https://winlibs.com/">winlibs</a>，提供默认不使用MSVC的Clang版本，下载试了试，真的是太香了。</p>
<p><em><strong>这样一来就可以不用WSL，完美在windows本地实现B站大佬的开发环境配置</strong></em></p>
<h1 id="安装软件"><a href="#安装软件" class="headerlink" title="安装软件"></a>安装软件</h1><p>用到的软件/插件(直接点击链接下载安装即可)：</p>
<p>软件：</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://code.visualstudio.com/">Visual Studio Code</a></li>
<li><a target="_blank" rel="noopener" href="https://cmake.org/download/">CMake</a></li>
<li><del><a target="_blank" rel="noopener" href="https://www.mingw-w64.org/downloads/">MinGW</a></del>(可以直接用打包好的LLVM就不用下载MinGW了)</li>
<li><a target="_blank" rel="noopener" href="https://winlibs.com/">LLVM</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/ninja-build/ninja/releases">Ninja</a></li>
</ul>
<p>插件：</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://marketplace.visualstudio.com/items?itemName=ms-vscode.cmake-tools">CMake Tools</a></li>
<li><a target="_blank" rel="noopener" href="https://marketplace.visualstudio.com/items?itemName=llvm-vs-code-extensions.vscode-clangd">clangd</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/vadimcn/vscode-lldb/releases">CodeLLDB</a></li>
</ul>
<p>某些官网或者github上不去可以直接在蓝奏云下载：</p>
<p><a target="_blank" rel="noopener" href="https://wwd.lanzouo.com/b02olvw6h">打包下载地址</a></p>
<p>密码:9uaq</p>
<h2 id="安装vscode"><a href="#安装vscode" class="headerlink" title="安装vscode"></a>安装vscode</h2><p>一路next</p>
<h2 id="安装cmake"><a href="#安装cmake" class="headerlink" title="安装cmake"></a>安装cmake</h2><p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://cdn.jsdelivr.net/gh/ambition-echo/img_bed/img/image-20211210172019994.png" alt="image-20211210172019994"></p>
<p>下载<code>.msi</code>格式的安装包来安装。</p>
<p>注意安装时勾选将cmake添加到path。</p>
<h2 id="安装编译器"><a href="#安装编译器" class="headerlink" title="安装编译器"></a>安装编译器</h2><p>到<a target="_blank" rel="noopener" href="https://winlibs.com/">winlibs</a>直接下载，按网站的说法这个打包在windows下提供了完整的编译器环境。</p>
<p>至于下载哪个版本，可以参照网站的说明。</p>
<blockquote>
<p>Traditionally the MinGW-w64 compiler used MSVCRT as runtime library, which is available on all versions of Windows.</p>
<p>Since Windows 10 Universal C Runtime (UCRT) is available as an alternative to MSVCRT. Universal C Runtime can also be installed on earlier versions of Windows (see: <a target="_blank" rel="noopener" href="https://support.microsoft.com/en-us/topic/update-for-universal-c-runtime-in-windows-c0514201-7fe6-95a3-b0a5-287930f3560c">Update for Universal C Runtime in Windows</a>).</p>
<p>Unless you are targetting older versions of Windows, UCRT as runtime library is the better choice, as it was written to better support recent Windows versions as well as provide better standards conformance (see also: <a target="_blank" rel="noopener" href="https://docs.microsoft.com/en-us/cpp/porting/upgrade-your-code-to-the-universal-crt?view=msvc-160">Upgrade your code to the Universal CRT</a>).</p>
</blockquote>
<p>大概意思就是说，首选下载ucrt版本。</p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://cdn.jsdelivr.net/gh/ambition-echo/img_bed/img/image-20211216222317595.png" alt="image-20211216222317595"></p>
<p>下载对应的包含LLVM的版本。</p>
<p>由于网站好像是在github托管的，可能会有上不去或者下载慢的问题，可以下载我存在网盘的：<a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1l-xWd83b_836LJbYM68gSA">百度网盘</a> 提取码: uppb </p>
<p>下载完成后，直接解压到要安装的路径下，再将其中的<code>bin</code>文件夹添加到环境变量即可。</p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://cdn.jsdelivr.net/gh/ambition-echo/img_bed/img/image-20211216223133463.png" alt="image-20211216223133463"></p>
<h2 id="安装Ninja"><a href="#安装Ninja" class="headerlink" title="安装Ninja"></a>安装Ninja</h2><p>下载之后将文件夹解压到一个固定位置之后，将文件夹添加到环境变量即可，由于是cmake在用，也可以直接把<code>ninja.exe</code>直接放到cmake安装目录下的<code>bin</code>文件夹下,就不用单独添加环境变量了。</p>
<h2 id="安装clangd"><a href="#安装clangd" class="headerlink" title="安装clangd"></a>安装clangd</h2><p>由于winlibs打包的编译器中有与之匹配的clangd，就在<code>bin</code>文件夹中，所以不需要单独安装，直接用即可。</p>
<h2 id="安装vscode插件"><a href="#安装vscode插件" class="headerlink" title="安装vscode插件"></a>安装vscode插件</h2><p>vscode中的插件，CMake Tools和clangd可以直接在vscode中搜索安装，没有问题，只是clangd与C/C++插件不兼容，要注意不要安装C/C++插件。</p>
<p>对于CodeLLDB，在vscode中安装大概率会下载失败，可以直接到github页面去下载<code>.vsix</code>文件手动安装.</p>
<h3 id="安装方法："><a href="#安装方法：" class="headerlink" title="安装方法："></a>安装方法：</h3><p>打开vscode，按F1，输入vsix，出现从VSIX安装，点击后选择下载的<code>.vsix</code>文件即可安装成功。</p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://cdn.jsdelivr.net/gh/ambition-echo/img_bed/img/image-20211210173926386.png" alt="image-20211210173926386"></p>
<h1 id="配置C-C-项目"><a href="#配置C-C-项目" class="headerlink" title="配置C/C++项目"></a>配置C/C++项目</h1><h2 id="项目结构"><a href="#项目结构" class="headerlink" title="项目结构"></a>项目结构</h2><p>新建一个文件夹作为项目目录，在目录下新建几个文件：</p>
<p>目录结构如下：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">├─src</span><br><span class="line">│  ├─Template.c</span><br><span class="line">│  └─Template.h</span><br><span class="line">├─CMakeLists.txt</span><br><span class="line">└─main.c</span><br></pre></td></tr></table></figure>

<p>在<code>src</code>目录中是自定义的头文件</p>
<h2 id="CMake"><a href="#CMake" class="headerlink" title="CMake"></a>CMake</h2><p>打开vscode设置，在cmake设置中找到Generator，将其指定为Ninja：</p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://cdn.jsdelivr.net/gh/ambition-echo/img_bed/img/image-20211210180528993.png" alt="image-20211210180528993"></p>
<p>CMakeLists.txt文件内容如下</p>
<figure class="highlight cmake"><table><tr><td class="code"><pre><span class="line"><span class="keyword">cmake_minimum_required</span>(VERSION <span class="number">3.20</span>)</span><br><span class="line"><span class="keyword">project</span>(Template C)</span><br><span class="line"></span><br><span class="line"><span class="keyword">set</span>(CMAKE_C_STANDARD <span class="number">23</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">add_executable</span>(<span class="variable">$&#123;CMAKE_PROJECT_NAME&#125;</span></span><br><span class="line">        main.c</span><br><span class="line">        src/Template.c</span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line"><span class="keyword">target_include_directories</span>(<span class="variable">$&#123;CMAKE_PROJECT_NAME&#125;</span> PRIVATE</span><br><span class="line">        src</span><br><span class="line">        )</span><br></pre></td></tr></table></figure>

<p>cmake_minimum_required()定义CMake最低版本为3.20</p>
<p>project()定义项目名称和项目类型</p>
<p>set(CMAKE_C_STANDARD 23)规定项目使用的C语言标准为C23</p>
<p>再下面两部分规定了项目包含的源文件以及include文件夹。</p>
<p>保存文件，会自动生成一个<code>build</code>文件夹。</p>
<h2 id="launch-json"><a href="#launch-json" class="headerlink" title="launch.json"></a>launch.json</h2><p>这时候按F5来调试程序，会自动在<code>.vscode</code>目录下生成一个<code>launch.json</code>文件。</p>
<p>将里面的内容改成如下所示：</p>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">&quot;version&quot;</span>: <span class="string">&quot;0.2.0&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;configurations&quot;</span>: [</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="attr">&quot;type&quot;</span>: <span class="string">&quot;lldb&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;request&quot;</span>: <span class="string">&quot;launch&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;name&quot;</span>: <span class="string">&quot;Debug&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;program&quot;</span>: <span class="string">&quot;$&#123;command:cmake.launchTargetPath&#125;&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;args&quot;</span>: [],</span><br><span class="line">            <span class="attr">&quot;cwd&quot;</span>: <span class="string">&quot;$&#123;workspaceFolder&#125;&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="clangd配置"><a href="#clangd配置" class="headerlink" title="clangd配置"></a>clangd配置</h2><p>打开vscode设置，在扩展中找到clangd，添加如下选项：</p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://cdn.jsdelivr.net/gh/ambition-echo/img_bed/img/image-20211210180255946.png" alt="image-20211210180255946"></p>
<ol>
<li>由于clangd需要读取cmake生成的compile-commands.json文件，所以需要指定其路径</li>
<li>设置clangd代码提示显示参数类型</li>
<li>设置从不导入头文件</li>
</ol>
<h1 id="测试程序"><a href="#测试程序" class="headerlink" title="测试程序"></a>测试程序</h1><p>编写简单的测试程序：</p>
<ul>
<li>main.c</li>
</ul>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;Template.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">template</span> x;</span><br><span class="line">    x.a = <span class="number">1</span>;</span><br><span class="line">    x.b = <span class="number">2</span>;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d %d&quot;</span>, x.a, x.b);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<ul>
<li>Template.c</li>
</ul>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;Template.h&quot;</span></span></span><br></pre></td></tr></table></figure>



<ul>
<li>Template.h</li>
</ul>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> &#123;</span></span><br><span class="line">  <span class="keyword">int</span> a;</span><br><span class="line">  <span class="keyword">int</span> b;</span><br><span class="line">&#125; <span class="keyword">template</span>;</span><br></pre></td></tr></table></figure>



<p>clangd的代码提示正常，按住ctrl点击头文件可以跳转。</p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://cdn.jsdelivr.net/gh/ambition-echo/img_bed/img/image-20211210180048976.png" alt="image-20211210180048976"></p>
<p>添加断点调试也没有问题。</p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://cdn.jsdelivr.net/gh/ambition-echo/img_bed/img/image-20211210180732375.png" alt="image-20211210180732375"></p>
<h1 id="设置运行及调试快捷键"><a href="#设置运行及调试快捷键" class="headerlink" title="设置运行及调试快捷键"></a>设置运行及调试快捷键</h1><p>为了方便运行，可以添加自定义快捷键，实现像code runner插件那样的运行体验。</p>
<h2 id="运行"><a href="#运行" class="headerlink" title="运行"></a>运行</h2><p>按F1，输入cmake，找到运行但不调试，点击右边的齿轮按钮来自定义快捷键。</p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://cdn.jsdelivr.net/gh/ambition-echo/img_bed/img/image-20211210181108443.png" alt="image-20211210181108443"></p>
<p>点击左边的编辑后输入要绑定的快捷键之后回车，这里就绑定为ctrl+alt+n，跟code runner一样，为了不发生冲突，找到code runner的运行快捷键，右键更改when表达式，填入如下：</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line">editorLangId != <span class="string">&#x27;c&#x27;</span> &amp;&amp; editorLangId != <span class="string">&#x27;cpp&#x27;</span></span><br></pre></td></tr></table></figure>

<p>这样，code runner的快捷键就不会在编写C/C++时生效了。</p>
<h2 id="调试"><a href="#调试" class="headerlink" title="调试"></a>调试</h2><p>默认的调试快捷键为F5，很方便，但为了符合习惯，将其改为ctrl+alt+m，方法同上，这一快捷键与code runner中的停止运行冲突，感觉这个快捷键没什么用，直接删了。</p>
<p>到此配置完成，源代码编辑完成后可以ctrl+alt+n运行，ctrl+allt+m调试，不影响code runner运行python之类的。</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">辛巳流火</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://huguoyang.cn/2021/12/10/CMAKE%E9%85%8D%E7%BD%AEC-C-%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83/">https://huguoyang.cn/2021/12/10/CMAKE%E9%85%8D%E7%BD%AEC-C-%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://huguoyang.cn" target="_blank">辛巳流火的Blog</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/C/">C</a><a class="post-meta__tags" href="/tags/vscode/">vscode</a></div><div class="post_share"><div class="social-share" data-image="https://cdn.jsdelivr.net/gh/ambition-echo/img_bed/img/1639111789400%E7%94%BB%E6%9D%BF%201.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2021/12/11/Windows%E4%B8%8BAria2%E4%B8%8B%E8%BD%BD%E5%99%A8%E6%9C%80%E4%BD%B3%E9%85%8D%E7%BD%AE/"><img class="prev-cover" src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://cdn.jsdelivr.net/gh/ambition-echo/img_bed/img/1639212516820d6dd3810f72506d006d3f23c67acd5a7.jpeg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">Windows下Aria2下载器最佳配置</div></div></a></div><div class="next-post pull-right"><a href="/2021/11/28/%E5%85%A8%E8%87%AA%E5%8A%A8%E6%89%98%E7%AE%A1%E9%9D%92%E5%B9%B4%E5%A4%A7%E5%AD%A6%E4%B9%A0/"><img class="next-cover" src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://cdn.jsdelivr.net/gh/ambition-echo/img_bed/img/20211128123036.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">全自动托管青年大学习</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2021/05/24/%E7%94%A8VSCode%E7%BC%96%E8%BE%91C51/" title="用VSCode编辑C51"><img class="cover" src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://cdn.jsdelivr.net/gh/ambition-echo/img_bed/img/20211114222001.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-05-24</div><div class="title">用VSCode编辑C51</div></div></a></div></div></div><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div id="gitalk-container"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://cdn.jsdelivr.net/gh/ambition-echo/img_bed/img/20211215232452.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">辛巳流火</div><div class="author-info__description"></div></div><div class="card-info-data"><div class="card-info-data-item is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">21</div></a></div><div class="card-info-data-item is-center"><a href="/tags/"><div class="headline">标签</div><div class="length-num">19</div></a></div><div class="card-info-data-item is-center"><a href="/categories/"><div class="headline">分类</div><div class="length-num">3</div></a></div></div><a class="button--animated" id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/ambition-echo"><i class="fab fa-github"></i><span>My Github</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://cdn.jsdelivr.net/gh/ambition-echo/img_bed/img/qq.jpg" target="_blank" title="QQ"><i class="fab fa-qq"></i></a><a class="social-icon" href="https://cdn.jsdelivr.net/gh/ambition-echo/img_bed/img/wechat.jpg" target="_blank" title="微信"><i class="fab fa-weixin"></i></a><a class="social-icon" href="mailto:ambition_echo@outlook.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a><a class="social-icon" href="https://t.me/ambition_echo" target="_blank" title="Telegram"><i class="fab fa-telegram"></i></a><a class="social-icon" href="https://twitter.com/ambitionecho" target="_blank" title="Twitter"><i class="fab fa-twitter"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn card-announcement-animation"></i><span>公告</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%AE%89%E8%A3%85%E8%BD%AF%E4%BB%B6"><span class="toc-text">安装软件</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%89%E8%A3%85vscode"><span class="toc-text">安装vscode</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%89%E8%A3%85cmake"><span class="toc-text">安装cmake</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%89%E8%A3%85%E7%BC%96%E8%AF%91%E5%99%A8"><span class="toc-text">安装编译器</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%89%E8%A3%85Ninja"><span class="toc-text">安装Ninja</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%89%E8%A3%85clangd"><span class="toc-text">安装clangd</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%89%E8%A3%85vscode%E6%8F%92%E4%BB%B6"><span class="toc-text">安装vscode插件</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%89%E8%A3%85%E6%96%B9%E6%B3%95%EF%BC%9A"><span class="toc-text">安装方法：</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E9%85%8D%E7%BD%AEC-C-%E9%A1%B9%E7%9B%AE"><span class="toc-text">配置C&#x2F;C++项目</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A1%B9%E7%9B%AE%E7%BB%93%E6%9E%84"><span class="toc-text">项目结构</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#CMake"><span class="toc-text">CMake</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#launch-json"><span class="toc-text">launch.json</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#clangd%E9%85%8D%E7%BD%AE"><span class="toc-text">clangd配置</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%B5%8B%E8%AF%95%E7%A8%8B%E5%BA%8F"><span class="toc-text">测试程序</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%AE%BE%E7%BD%AE%E8%BF%90%E8%A1%8C%E5%8F%8A%E8%B0%83%E8%AF%95%E5%BF%AB%E6%8D%B7%E9%94%AE"><span class="toc-text">设置运行及调试快捷键</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%BF%90%E8%A1%8C"><span class="toc-text">运行</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%B0%83%E8%AF%95"><span class="toc-text">调试</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2022/05/30/Linux%E4%B8%8B%E5%AE%89%E8%A3%85%E9%85%8D%E7%BD%AEMatlabR2019/" title="Linux下安装配置MatlabR2019"><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://cdn.jsdelivr.net/gh/ambition-echo/img_bed/img/image-20220530161040817.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Linux下安装配置MatlabR2019"/></a><div class="content"><a class="title" href="/2022/05/30/Linux%E4%B8%8B%E5%AE%89%E8%A3%85%E9%85%8D%E7%BD%AEMatlabR2019/" title="Linux下安装配置MatlabR2019">Linux下安装配置MatlabR2019</a><time datetime="2022-05-30T14:51:44.000Z" title="发表于 2022-05-30 14:51:44">2022-05-30</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/02/08/%E8%A7%A3%E5%86%B3Linux%E4%B8%8Bqtcreator%E6%97%A0%E6%B3%95%E8%BE%93%E5%85%A5%E4%B8%AD%E6%96%87%E7%9A%84%E9%97%AE%E9%A2%98/" title="解决Linux下qtcreator无法输入中文的问题"><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://cdn.jsdelivr.net/gh/ambition-echo/img_bed/img/image-20220208204737212.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="解决Linux下qtcreator无法输入中文的问题"/></a><div class="content"><a class="title" href="/2022/02/08/%E8%A7%A3%E5%86%B3Linux%E4%B8%8Bqtcreator%E6%97%A0%E6%B3%95%E8%BE%93%E5%85%A5%E4%B8%AD%E6%96%87%E7%9A%84%E9%97%AE%E9%A2%98/" title="解决Linux下qtcreator无法输入中文的问题">解决Linux下qtcreator无法输入中文的问题</a><time datetime="2022-02-08T20:42:25.000Z" title="发表于 2022-02-08 20:42:25">2022-02-08</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/12/15/%E4%BD%BF%E7%94%A8CDN%E5%8A%A0%E9%80%9F%E7%9A%84Github%E4%BD%9C%E4%B8%BA%E5%9B%BE%E5%BA%8A/" title="使用CDN加速的Github作为图床"><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://cdn.jsdelivr.net/gh/ambition-echo/img_bed/img/20211215230811.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="使用CDN加速的Github作为图床"/></a><div class="content"><a class="title" href="/2021/12/15/%E4%BD%BF%E7%94%A8CDN%E5%8A%A0%E9%80%9F%E7%9A%84Github%E4%BD%9C%E4%B8%BA%E5%9B%BE%E5%BA%8A/" title="使用CDN加速的Github作为图床">使用CDN加速的Github作为图床</a><time datetime="2021-12-15T22:20:50.000Z" title="发表于 2021-12-15 22:20:50">2021-12-15</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2022 By 辛巳流火</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">简</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><div class="search-dialog__title" id="local-search-title">本地搜索</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div></div><hr/><div id="local-search-results"></div><span class="search-close-button"><i class="fas fa-times"></i></span></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js"></script><script src="/js/search/local-search.js"></script><div class="js-pjax"><script>function addGitalkSource () {
  const ele = document.createElement('link')
  ele.rel = 'stylesheet'
  ele.href= 'https://cdn.jsdelivr.net/npm/gitalk/dist/gitalk.min.css'
  document.getElementsByTagName('head')[0].appendChild(ele)
}

function loadGitalk () {
  function initGitalk () {
    var gitalk = new Gitalk(Object.assign({
      clientID: 'd7df3ed4ef39590ee400',
      clientSecret: '4c9638f5d623bc0b9a4d409a78201d79dede0510',
      repo: 'ambition-echo.github.io',
      owner: 'ambition-echo',
      admin: ['ambition-echo'],
      id: '1908742e9eee396314d18a48cea4bcee',
      language: 'zh-CN',
      perPage: 6,
      distractionFreeMode: false,
      pagerDirection: 'last',
      createIssueManually: true,
      updateCountCallback: commentCount
    },null))

    gitalk.render('gitalk-container')
  }

  if (typeof Gitalk === 'function') initGitalk()
  else {
    addGitalkSource()
    getScript('https://cdn.jsdelivr.net/npm/gitalk@latest/dist/gitalk.min.js').then(initGitalk)
  }
}

function commentCount(n){
  let isCommentCount = document.querySelector('#post-meta .gitalk-comment-count')
  if (isCommentCount) {
    isCommentCount.innerHTML= n
  }
}

if ('Gitalk' === 'Gitalk' || !false) {
  if (false) btf.loadComment(document.getElementById('gitalk-container'), loadGitalk)
  else loadGitalk()
} else {
  function loadOtherComment () {
    loadGitalk()
  }
}</script></div><script defer="defer" id="fluttering_ribbon" mobile="true" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/canvas-fluttering-ribbon.min.js"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>